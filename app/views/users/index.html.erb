<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
body { font-family: "Times New Roman", Georgia, Serif; }
h1, h2, h4, h5, h6 {
  font-family: "Playfair Display";
  letter-spacing: 3px;
}
h3 {
  letter-spacing: 2px;
}
</style>
<head>
</head>
  <body>
    <!-- header -->
    <nav class="navbar navbar-expand-lg navbar-light" id="navbar_user">
      <div class="container">
        <div class="logo-item">
          <%= image_tag("l.png", alt: "logo_design", style: "height: 60px;") %>
        </div>
      </div>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <%= content_tag(:i, "blur_on", class: "material-icons", style: "color: white;") %>
      </button>
      <div class="collapse navbar-collapse nav-collapse" id="navbarNavDropdown">
        <div class="main-container">
          <ul class="navbar-nav">
            <li class="nav-item active">
              <%= link_to "Home", root_path, class: "nav-link" %>
            </li>
            <li class="nav-item active">
              <%= link_to "Submit a photo", new_post_path, class: "nav-link" %>
            </li>
            <li class="nav-item">
              <a href="#posts" class="nav-link">Photo by me</a>
            </li>
            <li class="nav-item">
              <% if user_signed_in? %>
              <%= link_to('Logout', destroy_user_session_path, method: :delete, class: "nav-link") %>
              <% else %>
                <%= link_to "Login", new_user_session_path, class: "nav-link" %>
                <% end %>
            </li>
            <li class="nav-item" id="btn-join">
              <% if !user_signed_in? %>
                <%= link_to "Join Free", new_user_registration_path, class: "nav-link" %>
              <% else %>
                <%= link_to "#{current_user.username}", users_path, class: "nav-link" %>
              <% end %>
            </li>
          </ul>
        </div>
      </div>
    </nav>
		<br>
    <!-- user & post -->
    <div class="w3-content" style="max-width:1100px">
      <div class="w3-row w3-padding-64" id="profile" style="border-radius: 100%;">
        <div class="w3-col m6 w3-padding-large">
        	<br><br>
          <% if current_user.avatar? %>
            <%= image_tag current_user.avatar.url, id: "avatar-user", class: "w3-round w3-image w3-min", style: "height:500px; width:500px; border-radius: 100%;" %>
          <% else %>
            <%= image_tag "no-avatar.gif", id: "avatar-user", class: " w3-image w3-min" %>
            <h6 class="w3-center">Without an avatar to display<br>Please select the edit profile button</h6>
          <% end %>
        </div>

        <div class="w3-col m6 w3-padding-large">
          <h1 class="w3-center">Welcome: <%= current_user.username %></h1><br>
          <h5 class="w3-center">Information</h5>
          <div style="text-align: center;"><%= link_to "Edit Profile", edit_user_registration_path, class: "btn btn-outline-dark", style: "text-align: center;" %></div>
          <p class="w3-large"><span class="w3-tag w3-light-grey">Download free, beautiful high-quality photos curated by: <%= current_user.username %>.</span></p>
          <p class="w3-large w3-text-grey w3-hide-medium"></p>
          <div class="alert alert-primary" role="alert">
					  User name: <%= current_user.username %>
					</div>
					<div class="alert alert-secondary" role="alert">
					  Full name: <%= current_user.fullname %>
					</div>
					<% if current_user.admin == true %>
						<div class="alert alert-success" role="alert">
						  Admin: <%= current_user.admin %>
						</div>
					<% end %>
					<div class="alert alert-danger" role="alert">
					  Email: <%= current_user.email %>
					</div>
					<div class="alert alert-warning" role="alert">
					  Phone number: <%= current_user.phone %>
					</div>
					<div class="alert alert-info" role="alert">
					  Location: <%= truncate(current_user.location, length: 70, omission: "...#{current_user.location[-5, 5]}") if current_user.location.present? %>
					</div>
					<p class="w3-center" style="font-weight: bold;">The total number of posts is: <%= current_user.posts.all.size %> </p>
          <div id="posts"></div>
        </div>
      </div>
    <hr class="w3-opacity">
    <div class="w3-row-padding w3-padding-16 w3-center">
      <% @user_posts.each do |post| %>
        <div class="w3-third">
          <div class="wrapper">
            <% if post.image? %>
            <div class="date">
              <span class="day"><%= post.created_at.day %></span>
              <span class="month"><%= Date::MONTHNAMES[post.created_at.month][0..2] %></span>
              <span class="year"><%= post.created_at.year %></span>
            </div>
              <%= link_to image_tag(post.image_url, alt: post.title, style: "width:100%;", border: 1, class: "img"), { controller: 'posts', action: 'show', id: post } %>
            <% else %>
            <%= link_to image_tag('no-image.jpg', alt: post.title, style: "width:100%;", class: "img"), { controller: 'posts', action: 'show', id: post } %>
            <% end %>
            <div class="data">
              <div class="content">
                <span class="author"><%= post.user.username if post.user.present? %></span>
                <h3 class="title"><%= truncate(post.title, length: 20, omission: "...#{post.title[-5, 5]}") if post.title.present? %></h3>
                <p class="w3-center text"><%= truncate(post.discription, length: 30, omission: "...#{post.discription[-5, 5]}") if post.discription.present? %></p>
                <label for="show-menu" class="menu-button"><span></span></label>
                </div>
              <input type="checkbox" id="show-menu" />
              <ul class="menu-content">
                <li><a href="#" class="fa fa-facebook-official"><span>5</span></a></li>
                <li><a href="#" class="fa fa-instagram"><span>47</span></a></li>
                <li><a href="#" class="fa fa-comment-o"><span>8</span></a></li>
              </ul>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="w3-center w3-padding-32">
      <div class="w3-bar">
        <%= paginate @user_posts %>
      </div>
    </div>
  </body>
</html>